{% extends "base.html" %}
{% block content %}
<div class="page">
    <header class="page-header">
        <div class="page-header-row">
            <div>
                <h1 class="title">CDX Web Scan</h1>
                <p class="subtitle">Enter or scan a UPC/EAN barcode.</p>
            </div>
            <button
                id="theme-toggle"
                class="icon-button"
                type="button"
                aria-label="Toggle light/dark mode"
                title="Toggle light/dark mode"
            >
                <span class="theme-icon" aria-hidden="true">â˜¾</span>
            </button>
        </div>
    </header>

    <section class="card">
        <form
            id="barcode-form"
            hx-post="/submit"
            hx-target="#scan-result"
            hx-swap="innerHTML"
        >
            <input type="hidden" id="source" name="source" value="manual" />

            <label class="label" for="barcode">UPC / EAN</label>
            <input
                class="input"
                id="barcode"
                name="barcode"
                inputmode="numeric"
                autocomplete="off"
                autocorrect="off"
                spellcheck="false"
                placeholder="Scan or type digits"
            />

            <label class="label" for="title" style="margin-top: 10px;">Title / Description (optional)</label>
            <input
                class="input"
                id="title"
                name="title"
                autocomplete="off"
                autocorrect="off"
                spellcheck="false"
                placeholder="e.g. Michael Jackson - Off the Wall"
            />

            <div class="actions">
                <button class="button" type="submit">Submit</button>
                <button class="button secondary" type="button" id="toggle-camera">Scan (Camera)</button>
            </div>
        </form>

        <div id="scan-result" class="result" aria-live="polite"></div>
    </section>

    <section class="card">
    <section id="camera-panel" class="card hidden" aria-hidden="true">
        <div class="camera-header">
            <h2 class="section-title">Camera Scan</h2>
            <button class="button secondary" type="button" id="stop-camera">Stop</button>
        </div>
        <p class="hint" id="camera-hint"></p>
        <video id="camera" class="camera" playsinline muted></video>
        <canvas id="camera-canvas" class="hidden"></canvas>
    </section>

    <section class="card">
        <div id="batch">
            {% include "batch_fragment.html" %}
        </div>
    </section>
</div>
{% endblock %}